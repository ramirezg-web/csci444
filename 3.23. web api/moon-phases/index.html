<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Moon Phases and Humidity</title>

    <link href="https://fonts.googleapis.com/css?family=Comfortaa&display=swap" rel="stylesheet">

    <style>
      body {background-color: black}

      h1 {
        font-family: Comfortaa;
        color: yellow;
        position: sticky;
        top: 10px;
      }

      .phase {
        fill: white;
        width: 200px;
        height: auto;
        padding-bottom: 50px;
        /* filter: blur(3px); */
      }
    </style>
  </head>

  <body>
    <h1>Moon Phases</h1>

    <svg class="phase">
      <use href="moon-phases.svg#wax1" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wax2" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wax3" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wax4" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wax5" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#full" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wane1" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wane2" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wane3" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wane4" />
    </svg>

    <svg class="phase">
      <use href="moon-phases.svg#wane5" />
    </svg>

    <script type="text/javascript">
    accessData= async()=> {
      let url= "https://api.openweathermap.org/data/2.5/weather?q=New+York&units=imperial&APPID=7f12974fb29ca234ee8dea4386063a22";
      //let response
      let response= await fetch(url);

      if (response.ok){ //http status of 200-299
        let json= await response.json();
        // console.log(json);
        weatherData(json);
      } else{
        console.log('error: '+ response.status);
      }
    }
    weatherData=(response)=>{
      let humidity=response.main.humidity;
      console.log("humidity: "+ humidity);
      //map humidity to blur extent
      let blurExtent=Math.round(humidity/10);
      console.log(blurExtent);
      //apply css blur filter

      let blurValue="blur("+blurExtent+"px)";
      let moonPhases=document.querySelectorAll('.phase');
      for (let phase=0; phase <moonPhases.length; phase++){
        moonPhases[phase].style.filter=blurValue;
      }

    }
    window.addEventListener('load',accessData);
    </script>
  </body>
</html>
